---

title: Try news commentary data with tran2tran model

keywords: fastai
sidebar: home_sidebar


---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/95_nc_tran2tran.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai2.basics</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="k">import</span> <span class="n">AutoTokenizer</span>
<span class="kn">from</span> <span class="nn">fastai_transformers_utils.all</span> <span class="k">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">nmt_try.models.patch</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">nmt_try.models.tran2tran</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">nmt_try.data.news_commentary</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">nmt_try.metrics</span> <span class="k">import</span> <span class="n">compute_bleu</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<p style="color: red;">
The default version of TensorFlow in Colab will soon switch to TensorFlow 2.x.<br>
We recommend you <a href="https://www.tensorflow.org/guide/migrate" target="_blank">upgrade</a> now 
or ensure your notebook will continue to use TensorFlow 1.x via the <code>%tensorflow_version 1.x</code> magic:
<a href="https://colab.research.google.com/notebooks/tensorflow_version.ipynb" target="_blank">more info</a>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># all_skip</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tok_data_loc</span> <span class="o">=</span> <span class="s1">&#39;./data/News_Commentary/tok-news-commentary-v14.en-zh.csv&#39;</span>
<span class="n">enc_model_name</span> <span class="o">=</span> <span class="s1">&#39;bert-base-cased&#39;</span>
<span class="n">dec_model_name</span> <span class="o">=</span> <span class="s1">&#39;hfl/chinese-bert-wwm-ext&#39;</span>
<span class="n">enc_seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">dec_seq_len</span> <span class="o">=</span> <span class="mi">65</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enc_tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">enc_model_name</span><span class="p">)</span>
<span class="n">dec_tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">dec_model_name</span><span class="p">)</span>
<span class="n">dec_tokenizer</span><span class="o">.</span><span class="n">add_special_tokens</span><span class="p">({</span><span class="s1">&#39;bos_token&#39;</span><span class="p">:</span> <span class="s1">&#39;[CLS]&#39;</span><span class="p">,</span> <span class="s1">&#39;eos_token&#39;</span><span class="p">:</span> <span class="s1">&#39;[SEP]&#39;</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Datasets">Datasets<a class="anchor-link" href="#Datasets">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">small_dss</span> <span class="o">=</span> <span class="n">get_nc_dss</span><span class="p">(</span><span class="n">tok_data_loc</span><span class="p">,</span> <span class="n">enc_tokenizer</span><span class="p">,</span> <span class="n">dec_tokenizer</span><span class="p">,</span> <span class="n">enc_seq_len</span><span class="p">,</span> <span class="n">dec_seq_len</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">dss</span> <span class="o">=</span> <span class="n">get_nc_dss</span><span class="p">(</span><span class="n">tok_data_loc</span><span class="p">,</span> <span class="n">enc_tokenizer</span><span class="p">,</span> <span class="n">dec_tokenizer</span><span class="p">,</span> <span class="n">enc_seq_len</span><span class="p">,</span> <span class="n">dec_seq_len</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model">Model<a class="anchor-link" href="#Model">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">enc_max_pos_id</span> <span class="o">=</span> <span class="n">enc_seq_len</span><span class="o">+</span><span class="mi">10</span>
<span class="n">enc_vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">enc_tokenizer</span><span class="p">)</span>
<span class="n">enc_pad_id</span> <span class="o">=</span> <span class="n">enc_tokenizer</span><span class="o">.</span><span class="n">pad_token_id</span>

<span class="n">dec_max_pos_id</span> <span class="o">=</span> <span class="n">dec_seq_len</span><span class="o">+</span><span class="mi">10</span>
<span class="n">dec_vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dec_tokenizer</span><span class="p">)</span>
<span class="n">dec_pad_id</span> <span class="o">=</span> <span class="n">dec_tokenizer</span><span class="o">.</span><span class="n">pad_token_id</span>

<span class="n">embeded_size</span> <span class="o">=</span> <span class="mi">768</span>
<span class="n">num_head</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">num_encoder_layers</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_decoder_layers</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">dim_feedforward</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="n">drop_p</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">xdel</span> tran2tran
<span class="o">%</span><span class="k">xdel</span> decoder
<span class="o">%</span><span class="k">xdel</span> encoder
<span class="n">encoder</span> <span class="o">=</span> <span class="n">TranEncoder</span><span class="p">(</span><span class="n">enc_vocab_size</span><span class="p">,</span> <span class="n">embeded_size</span><span class="p">,</span> <span class="n">enc_max_pos_id</span><span class="p">,</span> <span class="n">enc_pad_id</span><span class="p">)</span>
<span class="n">decoder</span> <span class="o">=</span> <span class="n">TranDecoder</span><span class="p">(</span><span class="n">dec_vocab_size</span><span class="p">,</span> <span class="n">embeded_size</span><span class="p">,</span> <span class="n">dec_max_pos_id</span><span class="p">,</span> <span class="n">dec_pad_id</span><span class="p">)</span>
<span class="n">tran2tran</span> <span class="o">=</span> <span class="n">Tran2Tran</span><span class="p">(</span><span class="n">encoder</span><span class="p">,</span> <span class="n">decoder</span><span class="p">,</span> <span class="n">enc_pad_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Learner-and-Train">Learner and Train<a class="anchor-link" href="#Learner-and-Train">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">xdel</span> dls
<span class="o">%</span><span class="k">xdel</span> learn
<span class="c1"># dls = small_dss.dataloaders(bs=64)</span>
<span class="n">dls</span> <span class="o">=</span> <span class="n">dss</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> 
                <span class="n">tran2tran</span><span class="p">,</span> 
                <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(</span><span class="n">ignore_index</span><span class="o">=</span><span class="n">dec_pad_id</span><span class="p">),</span> 
                <span class="n">opt_func</span><span class="o">=</span><span class="n">Adam</span><span class="p">,</span>
                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">Perplexity</span><span class="p">()],</span>
               <span class="p">)</span><span class="o">.</span><span class="n">to_fp16</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.03630780577659607, 0.3019951581954956)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
ppGdmUqbzDSy0uPzUIuINF/xHqgPYlggzOxZ4Gigo5mtBG4h3Gk9HsgH3jCzz9z9RDPbC3jU3U92
92ozuxaYDKQCj7v7l7HK2ZCKUA2byqrYtDVE0ZZKvt1Yxrcby1ixsYyizZVsrqhmc0Uo/LWyeofn
ykpPoV12BnnZGeRkppGWaqSmGOmpKeRkpdGhdSYd2mTQvnUGuVnp5GSlkZMVLixbKsOfU1peTVVN
La3SU8NLRiqtM9PIzUojt1X4mMw0FSKR5mr7UN9xfA4iZgXC3cc28NZLUfZdDZxcZ30SMClG0b6n
ttZ54IOvWbmpnNXF5awqLue74nK2VtX8YN+MtBR6tGtF59wsenfMJicrnTaZaeRlp5PXKp287Axy
W6VRVV3L1soatlZVs7mimuKyKjaVhSguq2JLZTVV1bWEap3qmlqWrKtmw5bKqJ+3q1pnpNKudbjQ
tG2VTlZ6anhJS6F1JGe4UKXTq0Nr9u+So9aNSJJoVi2IZJGSYjz0wdekp6awV14r9slvw5H9OtKx
TSbtsjNo3zqdDm0y6dEum045maSkxOYR94pQDRu2VlFaHtreaqgI1ZKTlba9VZGemkJFqIbyUA1l
VTVsrQwXoNKKEKXlITaVhdi0tYqNZVUUl4Uo2lxJZXUtlaEaNkf2rSstxdi3cw4DurVlcM88Du7Z
jn6d2sTs3ygiu6+4vBm1IJLJx/95XOCXZ7LSU+mW14puea1i9hnVNbUUl4eLyNdFW5i7soQvVpUw
ef4anisM31mck5nG4J55jOjTgRF9OjCwe1vSUxPxXgaRlqWkLDySa9tW8bvNVQUCAi8O8ZKWmkLH
Npl0bJNJv845jDqoKwDuzrL1W/lkRTGfrNjEnOWbuGNy+HnG7IxUDuvbgbMLenDM/p1IU7EQCYQu
MUkgzIw++W3ok9+GMUO7A7BhSyWzl21kxtINTP5yDW8vWEeX3CzOHtaDc4f1YK8YtnRE5IeKy0Jk
Z6SSkRa/P9JUICSqDm0yOWlAV04a0JXfntKfdxau49nZKxj/7mImvLuY4w7ozEWH9uawvh3UZyES
B/EeZgNUIKQR0lJTOPHALpx4YBe+3VjGX2ev4LmPv+Wt+Wvp07E1Vx7dlzOGdNPlJ5EYKg6gQOgn
WnZJj/bZ/HLU/sz49THcfc4gWmemcfMLcznxnqlM+uI73D3oiCLNUhAtCBUI2S2ZaamcPqQ7r157
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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>perplexity</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>nan</td>
      <td>nan</td>
      <td>0.446425</td>
      <td>nan</td>
      <td>23:35</td>
    </tr>
    <tr>
      <td>1</td>
      <td>nan</td>
      <td>12:58</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-13-6548b19d49a5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>learn<span class="ansi-blue-fg">.</span>fit_one_cycle<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">5e-4</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/fastai2/callback/schedule.py</span> in <span class="ansi-cyan-fg">fit_one_cycle</span><span class="ansi-blue-fg">(self, n_epoch, lr_max, div, div_final, pct_start, wd, moms, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">     88</span>     scheds = {&#39;lr&#39;: combined_cos(pct_start, lr_max/div, lr_max, lr_max/div_final),
<span class="ansi-green-intense-fg ansi-bold">     89</span>               &#39;mom&#39;: combined_cos(pct_start, *(self.moms if moms is None else moms))}
<span class="ansi-green-fg">---&gt; 90</span><span class="ansi-red-fg">     </span>self<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span>n_epoch<span class="ansi-blue-fg">,</span> cbs<span class="ansi-blue-fg">=</span>ParamScheduler<span class="ansi-blue-fg">(</span>scheds<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">+</span>L<span class="ansi-blue-fg">(</span>cbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> reset_opt<span class="ansi-blue-fg">=</span>reset_opt<span class="ansi-blue-fg">,</span> wd<span class="ansi-blue-fg">=</span>wd<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     91</span> 
<span class="ansi-green-intense-fg ansi-bold">     92</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/fastai2/learner.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, n_epoch, lr, wd, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    292</span>                     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    293</span>                         self<span class="ansi-blue-fg">.</span>epoch<span class="ansi-blue-fg">=</span>epoch<span class="ansi-blue-fg">;</span>          self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_epoch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 294</span><span class="ansi-red-fg">                         </span>self<span class="ansi-blue-fg">.</span>_do_epoch_train<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    295</span>                         self<span class="ansi-blue-fg">.</span>_do_epoch_validate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    296</span>                     <span class="ansi-green-fg">except</span> CancelEpochException<span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_epoch&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/fastai2/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch_train</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    267</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    268</span>             self<span class="ansi-blue-fg">.</span>dl <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dls<span class="ansi-blue-fg">.</span>train<span class="ansi-blue-fg">;</span>                        self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 269</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>all_batches<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    270</span>         <span class="ansi-green-fg">except</span> CancelTrainException<span class="ansi-blue-fg">:</span>                         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>                                             self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_train&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/fastai2/learner.py</span> in <span class="ansi-cyan-fg">all_batches</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    245</span>     <span class="ansi-green-fg">def</span> all_batches<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    246</span>         self<span class="ansi-blue-fg">.</span>n_iter <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 247</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    248</span> 
<span class="ansi-green-intense-fg ansi-bold">    249</span>     <span class="ansi-green-fg">def</span> one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> i<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/fastai2/learner.py</span> in <span class="ansi-cyan-fg">one_batch</span><span class="ansi-blue-fg">(self, i, b)</span>
<span class="ansi-green-intense-fg ansi-bold">    251</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    252</span>             self<span class="ansi-blue-fg">.</span>_split<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>                                  self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_batch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 253</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>pred <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>xb<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>                self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_pred&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    254</span>             <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span>
<span class="ansi-green-intense-fg ansi-bold">    255</span>             self<span class="ansi-blue-fg">.</span>loss <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>loss_func<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>pred<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>self<span class="ansi-blue-fg">.</span>yb<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span> self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_loss&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *input, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    530</span>             result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_slow_forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    531</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 532</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    533</span>         <span class="ansi-green-fg">for</span> hook <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_forward_hooks<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    534</span>             hook_result <span class="ansi-blue-fg">=</span> hook<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">,</span> result<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/content/gdrive/My Drive/Colab_Codes/nmt_try/nmt_try/models/tran2tran.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">(self, src_input_ids, tgt_input_ids)</span>
<span class="ansi-green-intense-fg ansi-bold">    174</span> 
<span class="ansi-green-intense-fg ansi-bold">    175</span>         src_key_padding_mask <span class="ansi-blue-fg">=</span> gen_key_padding_mask<span class="ansi-blue-fg">(</span>src_input_ids<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>enc_pad_id<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># (bs, enc_seq_len)</span>
<span class="ansi-green-fg">--&gt; 176</span><span class="ansi-red-fg">         </span>memory <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>encoder<span class="ansi-blue-fg">(</span>src_input_ids<span class="ansi-blue-fg">,</span> src_key_padding_mask<span class="ansi-blue-fg">=</span>src_key_padding_mask<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># (bs, enc_seq_len, embeded_size)</span>
<span class="ansi-green-intense-fg ansi-bold">    177</span>         output<span class="ansi-blue-fg">,</span> _ <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>decoder<span class="ansi-blue-fg">(</span>tgt_input_ids<span class="ansi-blue-fg">,</span> memory<span class="ansi-blue-fg">,</span> memory_key_padding_mask<span class="ansi-blue-fg">=</span>src_key_padding_mask<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># (bs, dec_seq_len, embeded_size)</span>
<span class="ansi-green-intense-fg ansi-bold">    178</span>         <span class="ansi-green-fg">return</span> output

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *input, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    530</span>             result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_slow_forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    531</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 532</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    533</span>         <span class="ansi-green-fg">for</span> hook <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_forward_hooks<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    534</span>             hook_result <span class="ansi-blue-fg">=</span> hook<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">,</span> result<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/content/gdrive/My Drive/Colab_Codes/nmt_try/nmt_try/models/tran2tran.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">(self, src_input_ids, src_key_padding_mask)</span>
<span class="ansi-green-intense-fg ansi-bold">     89</span>                 memory<span class="ansi-blue-fg">:</span> <span class="ansi-blue-fg">(</span>bs<span class="ansi-blue-fg">,</span> enc_seq_len<span class="ansi-blue-fg">,</span> embeded_size<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     90</span>         &#39;&#39;&#39;
<span class="ansi-green-fg">---&gt; 91</span><span class="ansi-red-fg">         </span>embed <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>embedding<span class="ansi-blue-fg">(</span>src_input_ids<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># (bs, enc_seq_len)</span>
<span class="ansi-green-intense-fg ansi-bold">     92</span>         memory <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>encoder<span class="ansi-blue-fg">(</span>embed<span class="ansi-blue-fg">,</span> src_key_padding_mask<span class="ansi-blue-fg">=</span>src_key_padding_mask<span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># (bs, enc_seq_len, embeded_size)</span>
<span class="ansi-green-intense-fg ansi-bold">     93</span>         <span class="ansi-green-fg">return</span> memory <span class="ansi-red-fg"># (bs, enc_seq_len, embeded_size)</span>

<span class="ansi-green-fg">/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *input, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    530</span>             result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_slow_forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    531</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 532</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>forward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>input<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    533</span>         <span class="ansi-green-fg">for</span> hook <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>_forward_hooks<span class="ansi-blue-fg">.</span>values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    534</span>             hook_result <span class="ansi-blue-fg">=</span> hook<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> input<span class="ansi-blue-fg">,</span> result<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/content/gdrive/My Drive/Colab_Codes/nmt_try/nmt_try/models/tran2tran.py</span> in <span class="ansi-cyan-fg">forward</span><span class="ansi-blue-fg">(self, input_ids)</span>
<span class="ansi-green-intense-fg ansi-bold">     58</span>         scale <span class="ansi-blue-fg">=</span> torch<span class="ansi-blue-fg">.</span>sqrt<span class="ansi-blue-fg">(</span>torch<span class="ansi-blue-fg">.</span>tensor<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>embeded_size<span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>float<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     59</span> 
<span class="ansi-green-fg">---&gt; 60</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> word_embedding<span class="ansi-blue-fg">*</span>scale <span class="ansi-blue-fg">+</span> position_embedding  <span class="ansi-red-fg"># (b, seq_len, embeded_size)</span>
<span class="ansi-green-intense-fg ansi-bold">     61</span> 
<span class="ansi-green-intense-fg ansi-bold">     62</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">tran2tran</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="s1">&#39;./models/1-nc_tran2tran.pt&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tran2tran</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;./models/1-nc_tran2tran.pt&#39;</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bleu">Bleu<a class="anchor-link" href="#Bleu">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">generated_tran2tran</span> <span class="o">=</span> <span class="n">GeneratedTran2Tran</span><span class="p">(</span><span class="n">tran2tran</span><span class="p">,</span> <span class="n">enc_tokenizer</span><span class="p">,</span> <span class="n">dec_tokenizer</span><span class="p">)</span>
<span class="n">generate_args</span> <span class="o">=</span> <span class="n">GenerateArgs</span><span class="p">(</span>   
    <span class="n">max_length</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span>
<span class="c1">#     do_sample=True,</span>
    <span class="n">num_beams</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="c1">#     top_k=3, </span>
<span class="c1">#     top_p=0.9, </span>
<span class="c1">#     repetition_penalty=5,</span>
<span class="c1">#     length_penalty=6,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">compute_bleu</span><span class="p">(</span><span class="n">generated_tran2tran</span><span class="p">,</span> <span class="n">generate_args</span><span class="p">,</span> <span class="n">dec_tokenizer</span><span class="p">,</span> <span class="n">dls</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generate">Generate<a class="anchor-link" href="#Generate">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">generate_args</span> <span class="o">=</span> <span class="n">GenerateArgs</span><span class="p">(</span>   
    <span class="n">max_length</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span>
<span class="c1">#     do_sample=True,</span>
    <span class="n">num_beams</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="c1">#     top_k=3, </span>
<span class="c1">#     top_p=0.9, </span>
<span class="c1">#     repetition_penalty=5,</span>
<span class="c1">#     length_penalty=6,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">src_strs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;They have their own vision; their own planners, architects, and engineers; and their own manpower.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;As demand rises, more and better jobs will be created not only in Asia, but also globally, along supply chains and across production networks.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;If the EU is to progress beyond the limits of a common economic and monetary policy and develop a defense and security policy along with a common foreign policy, the UK must be on board.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Today, when a new strain of influenza appears in Asia, scientists collect a throat swab, isolate the virus, and run the strain’s genetic sequence.&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Other elements of Lee’s plan include construction of eco-friendly transportation networks, such as high-speed railways and hundreds of kilometers of bicycle tracks, and generating energy using waste methane from landfills.&#39;</span><span class="p">,</span>

<span class="p">]</span>
<span class="n">tgt_strs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;他们有自己的愿景，自己的规划师、建筑师和工程师，自己的劳动力。&#39;</span><span class="p">,</span>
    <span class="s1">&#39;随着需求不断攀升，不仅亚洲会创造出更多更好的就业机会，全球范围内的供应链及整个生产网络也将会从中受益。&#39;</span><span class="p">,</span>
    <span class="s1">&#39;如果欧盟想要突破共同的经济和货币政策的界限，在发展安全防卫政策的同时发展共同的外交政策，英国必须参与。&#39;</span><span class="p">,</span>
    <span class="s1">&#39;如今，当新的流感菌株在亚洲出现时，科学家收集咽喉棉签，分离病毒，测定毒株的基因序列。&#39;</span><span class="p">,</span>
    <span class="s1">&#39;李总统计划的其他要素还包括建设生态友好的运输网络，例如高速铁路以及几百公里长的自行车车道，并且从垃圾堆中利用甲烷来制造能源。&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">generated_tran2tran</span><span class="o">.</span><span class="n">generate_from_strs</span><span class="p">(</span><span class="n">src_strs</span><span class="p">,</span> <span class="n">generate_args</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;They must be able to be able to ensure that they must be able to ensure that they&#39;,
 &#39;The world’s energy sector is not just the world’s largest energy,&#39;,
 &#39;The EU’s leaders must be able to pursue the EU’s economic and&#39;,
 &#39;For example, the world’s most recent population is the world’s most&#39;,
 &#39;For example, the government’s government has been able to use the public’&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

