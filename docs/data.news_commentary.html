---

title: Data News_Commentary

keywords: fastai
sidebar: home_sidebar

summary: "English to Chinese pairs"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/02_data.news_commentary.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<p style="color: red;">
The default version of TensorFlow in Colab will soon switch to TensorFlow 2.x.<br>
We recommend you <a href="https://www.tensorflow.org/guide/migrate" target="_blank">upgrade</a> now 
or ensure your notebook will continue to use TensorFlow 1.x via the <code>%tensorflow_version 1.x</code> magic:
<a href="https://colab.research.google.com/notebooks/tensorflow_version.ipynb" target="_blank">more info</a>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<p style="color: red;">
The default version of TensorFlow in Colab will soon switch to TensorFlow 2.x.<br>
We recommend you <a href="https://www.tensorflow.org/guide/migrate" target="_blank">upgrade</a> now 
or ensure your notebook will continue to use TensorFlow 1.x via the <code>%tensorflow_version 1.x</code> magic:
<a href="https://colab.research.google.com/notebooks/tensorflow_version.ipynb" target="_blank">more info</a>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># all_skip</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ori_data_loc = &#39;./data/News_Commentary/news-commentary-v14.en-zh.tsv&#39;</span>
<span class="c1"># tok_data_loc = &#39;./data/News_Commentary/tok-news-commentary-v14.en-zh.csv&#39;</span>
<span class="c1"># enc_tokenizer = AutoTokenizer.from_pretrained(&#39;hfl/chinese-bert-wwm-ext&#39;)</span>
<span class="c1"># dec_tokenizer = GPT2DecoderTokenizer.from_pretrained(&#39;distilgpt2&#39;)</span>
<span class="c1"># enc_seq_len = 65</span>
<span class="c1"># dec_seq_len = 100</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ori_data_loc</span> <span class="o">=</span> <span class="s1">&#39;./data/News_Commentary/news-commentary-v14.en-zh.tsv&#39;</span>
<span class="n">tok_data_loc</span> <span class="o">=</span> <span class="s1">&#39;./data/News_Commentary/tok-news-commentary-v14.en-zh.csv&#39;</span>
<span class="n">enc_tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;bert-base-cased&#39;</span><span class="p">)</span>
<span class="n">dec_tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;hfl/chinese-bert-wwm-ext&#39;</span><span class="p">)</span>
<span class="n">enc_seq_len</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">dec_seq_len</span> <span class="o">=</span> <span class="mi">65</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="tokenize_data">tokenize_data<a class="anchor-link" href="#tokenize_data">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># # export</span>
<span class="c1"># def _tokenize_data(ori_data_loc, enc_tokenizer, dec_tokenizer):</span>
<span class="c1">#     df = pd.read_csv(ori_data_loc, header=None, names=[&#39;English&#39;, &#39;Chinese&#39;], delimiter=&#39;\t&#39;, error_bad_lines=False, warn_bad_lines=False)</span>
<span class="c1">#     df.dropna(inplace=True)</span>
<span class="c1">#     df.reset_index(drop=True, inplace=True)</span>
    
<span class="c1">#     tok_np = np.zeros((len(df), 2)).astype(&#39;object&#39;)</span>
<span class="c1">#     for i, eng_str, chn_str in progress_bar(tuple(df.itertuples())):</span>
<span class="c1">#         tok_ch = &#39; &#39;.join(enc_tokenizer.tokenize(chn_str))</span>
<span class="c1">#         tok_en = &#39; &#39;.join(dec_tokenizer.tokenize(eng_str))</span>
<span class="c1">#         tok_np[i, 0] = tok_en</span>
<span class="c1">#         tok_np[i, 1] = tok_ch</span>
<span class="c1">#     tok_df = pd.DataFrame(tok_np, columns=[&#39;English&#39;, &#39;Chinese&#39;])</span>

<span class="c1">#     return tok_df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># skip</span>
<span class="c1"># tokenize, clean data and save it to tok_data_loc</span>
<span class="n">tok_df</span> <span class="o">=</span> <span class="n">_tokenize_data</span><span class="p">(</span><span class="n">ori_data_loc</span><span class="p">,</span> <span class="n">enc_tokenizer</span><span class="p">,</span> <span class="n">dec_tokenizer</span><span class="p">)</span>
<span class="n">tok_df</span> <span class="o">=</span> <span class="n">_clean_data</span><span class="p">(</span><span class="n">tok_df</span><span class="p">)</span>
<span class="n">tok_df</span> <span class="o">=</span> <span class="n">_small_data</span><span class="p">(</span><span class="n">tok_df</span><span class="p">)</span>
<span class="n">tok_df</span> <span class="o">=</span> <span class="n">_add_isvalid</span><span class="p">(</span><span class="n">tok_df</span><span class="p">)</span>
<span class="n">tok_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">tok_data_loc</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">tok_df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
            .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
                background: #F44336;
            }
        </style>
      <progress value='298106' class='' max='298106', style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [298106/298106 03:00<00:00]
    </div>
    
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>English</th>
      <th>Chinese</th>
      <th>is_valid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1929 or 1989 ?</td>
      <td>1929 年 还 是 1989 年 ?</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PA ##RI ##S – As the economic crisis deep ##ens and widen ##s , the world has been searching for historical analog ##ies to help us understand what has been happening .</td>
      <td>巴 黎 - 随 着 经 济 危 机 不 断 加 深 和 蔓 延 ， 整 个 世 界 一 直 在 寻 找 历 史 上 的 类 似 事 件 希 望 有 助 于 我 们 了 解 目 前 正 在 发 生 的 情 况 。</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>At the start of the crisis , many people like ##ned it to 1982 or 1973 , which was reassuring , because both dates refer to classical c ##yclic ##al down ##turn ##s .</td>
      <td>一 开 始 ， 很 多 人 把 这 次 危 机 比 作 1982 年 或 1973 年 所 发 生 的 情 况 ， 这 样 得 类 比 是 令 人 宽 心 的 ， 因 为 这 两 段 时 期 意 味 着 典 型 的 周 期 性 衰 退 。</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The tendency is either excessive restraint ( Europe ) or a diffusion of the effort ( the United States ) .</td>
      <td>目 前 的 趋 势 是 ， 要 么 是 过 度 的 克 制 （ 欧 洲 ） ， 要 么 是 努 力 的 扩 展 （ 美 国 ） 。</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Europe is being cautious in the name of avoiding debt and defending the euro , whereas the US has moved on many fronts in order not to waste an ideal opportunity to implement badly needed structural reforms .</td>
      <td>欧 洲 在 避 免 债 务 和 捍 卫 欧 元 的 名 义 下 正 变 得 谨 慎 ， 而 美 国 已 经 在 许 多 方 面 行 动 起 来 ， 以 利 用 这 一 理 想 的 时 机 来 实 行 急 需 的 结 构 性 改 革 。</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>256087</th>
      <td>He is part of the proud generation that defeated apartheid – and then peacefully engineered a transition to du ##rable black - majority rule .</td>
      <td>他 是 打 败 种 族 隔 离 制 度 [UNK] [UNK] 然 后 让 南 非 和 平 过 渡 到 由 人 口 占 多 数 的 黑 人 进 行 长 期 统 治 [UNK] [UNK] 的 自 豪 的 一 代 人 的 一 部 分 。</td>
      <td>False</td>
    </tr>
    <tr>
      <th>256088</th>
      <td>Their achievement remains one of the greatest in recent history .</td>
      <td>这 一 代 人 的 成 就 是 现 代 史 上 最 伟 大 的 成 就 之 一 。</td>
      <td>False</td>
    </tr>
    <tr>
      <th>256089</th>
      <td>At the same time , Z ##uma ’ s revolutionary generation still seems uneasy leading South Africa in a post - apartheid era that is now 15 years old .</td>
      <td>同 时 ， 祖 马 革 命 的 一 代 似 乎 对 领 导 打 破 种 族 隔 离 制 度 15 年 后 的 南 非 ， 还 不 适 应 。</td>
      <td>False</td>
    </tr>
    <tr>
      <th>256090</th>
      <td>In a region that re ##vere ##s the elderly , Z ##uma ’ s attachment to his rural traditions must be matched by an equal open ##ness to the appetite ##s of the country ’ s youth .</td>
      <td>在 一 个 尊 敬 老 人 的 地 区 ， 祖 马 对 其 乡 下 传 统 的 依 恋 ， 必 须 和 对 南 非 年 青 人 的 爱 好 所 持 的 平 等 而 开 放 态 度 相 平 衡 。</td>
      <td>False</td>
    </tr>
    <tr>
      <th>256091</th>
      <td>Three in ten South Africans are younger than 15 , meaning that they did not live a day under apartheid .</td>
      <td>在 南 非 ， 每 10 个 人 中 就 有 三 个 人 的 年 龄 小 于 15 岁 ， 这 意 味 着 ， 这 些 人 从 来 没 有 在 种 族 隔 离 制 度 下 生 活 过 。</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>256092 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># skip</span>
<span class="n">eda_tok_df</span> <span class="o">=</span> <span class="n">_get_eda_tok_df</span><span class="p">(</span><span class="n">tok_df</span><span class="p">)</span>
<span class="n">eda_tok_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>eng_len</th>
      <th>chn_len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>256092.000000</td>
      <td>256092.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>24.718765</td>
      <td>34.899095</td>
    </tr>
    <tr>
      <th>std</th>
      <td>10.524990</td>
      <td>14.172736</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>17.000000</td>
      <td>24.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>24.000000</td>
      <td>35.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>32.000000</td>
      <td>46.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>98.000000</td>
      <td>62.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="get_datasets">get_datasets<a class="anchor-link" href="#get_datasets">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_nc_dss" class="doc_header"><code>get_nc_dss</code><a href="https://github.com/cwza/nmt_try/tree/master/nmt_try/data/news_commentary.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_nc_dss</code>(<strong><code>tok_data_loc</code></strong>, <strong><code>enc_tokenizer</code></strong>, <strong><code>dec_tokenizer</code></strong>, <strong><code>enc_seq_len</code></strong>, <strong><code>dec_seq_len</code></strong>, <strong><code>pct</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">small_dss</span> <span class="o">=</span> <span class="n">get_nc_dss</span><span class="p">(</span><span class="n">tok_data_loc</span><span class="p">,</span> <span class="n">enc_tokenizer</span><span class="p">,</span> <span class="n">dec_tokenizer</span><span class="p">,</span> <span class="n">enc_seq_len</span><span class="p">,</span> <span class="n">dec_seq_len</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">dss</span> <span class="o">=</span> <span class="n">get_nc_dss</span><span class="p">(</span><span class="n">tok_data_loc</span><span class="p">,</span> <span class="n">enc_tokenizer</span><span class="p">,</span> <span class="n">dec_tokenizer</span><span class="p">,</span> <span class="n">enc_seq_len</span><span class="p">,</span> <span class="n">dec_seq_len</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">small_dss</span><span class="o">.</span><span class="n">train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dss</span><span class="o">.</span><span class="n">train</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dss</span><span class="o">.</span><span class="n">train</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">dss</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">dss</span><span class="o">.</span><span class="n">train</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((TensorText([  101,  6355,   117,  1607,  1110, 17111,   117,  1105,  1103,  1646,
            117,  2693,  1157,  3407,  4812,  1111,  2052,   787,   188,  4265,
           5532,   117,  1336, 12982,  1107,  1618,  3571,  1190,  1211,  2182,
           1121,  1103,   182,  6533,  3954,   119,   102,     0,     0,     0,
              0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
              0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
              0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
              0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
              0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
              0,     0,     0,     0,     0,     0,     0,     0,     0,     0]),
  TensorText([ 101, 5445, 1325, 1380, 3221,  679, 1062, 2398, 4638,  511, 2226, 5052,
          5401, 1744, 6206,  711, 2496,  791, 4638, 1059, 4413, 1314, 3322, 6566,
          3291, 1920, 4638, 6569,  818, 8024,  852, 5401, 1744, 1377, 5543,  833,
          3683, 1920, 1914, 3144, 1744, 2157,  809, 3291, 5679, 1962, 4638, 1232,
          2578, 6624, 1139, 1737, 1862,  511,  102,    0,    0,    0,    0,    0,
             0,    0,    0,    0,    0]),
  TensorText([5445, 1325, 1380, 3221,  679, 1062, 2398, 4638,  511, 2226, 5052, 5401,
          1744, 6206,  711, 2496,  791, 4638, 1059, 4413, 1314, 3322, 6566, 3291,
          1920, 4638, 6569,  818, 8024,  852, 5401, 1744, 1377, 5543,  833, 3683,
          1920, 1914, 3144, 1744, 2157,  809, 3291, 5679, 1962, 4638, 1232, 2578,
          6624, 1139, 1737, 1862,  511,  102,    0,    0,    0,    0,    0,    0,
             0,    0,    0,    0,    0])),
 (&#39;[CLS] Yet, history is unfair, and the US, despite its greater responsibility for today ’ s global crisis, may emerge in better shape than most countries from the morass. [SEP]&#39;,
  &#39;[CLS] 而 历 史 是 不 公 平 的 。 尽 管 美 国 要 为 当 今 的 全 球 危 机 负 更 大 的 责 任 ， 但 美 国 可 能 会 比 大 多 数 国 家 以 更 良 好 的 势 态 走 出 困 境 。 [SEP]&#39;,
  &#39;而 历 史 是 不 公 平 的 。 尽 管 美 国 要 为 当 今 的 全 球 危 机 负 更 大 的 责 任 ， 但 美 国 可 能 会 比 大 多 数 国 家 以 更 良 好 的 势 态 走 出 困 境 。 [SEP]&#39;))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dss</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([2, 100]) torch.int64 cuda:0 &lt;class &#39;fastai2.text.data.TensorText&#39;&gt;
torch.Size([2, 65]) torch.int64 cuda:0 &lt;class &#39;fastai2.text.data.TensorText&#39;&gt;
torch.Size([2, 65]) torch.int64 cuda:0 &lt;class &#39;fastai2.text.data.TensorText&#39;&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

